version: '3.8'
services:
  kafka:
    image: apache/kafka:latest
    container_name: kafka
    ports:
      - "9092:9092"
    environment:
      # Configurações KRaft (modo combinado broker+controller)
      KAFKA_NODE_ID: 1                          # ID único deste nó
      KAFKA_PROCESS_ROLES: "broker,controller"  # Habilita funções de broker e controller:contentReference[oaicite:2]{index=2}:contentReference[oaicite:3]{index=3}
      KAFKA_CONTROLLER_LISTENER_NAMES: "CONTROLLER"
      KAFKA_CONTROLLER_QUORUM_VOTERS: "1@localhost:9093"  # Quorum de controle (ID@host:porta):contentReference[oaicite:4]{index=4}:contentReference[oaicite:5]{index=5}
      # Listeners e protocolos
      KAFKA_LISTENERS: "PLAINTEXT://:9092,CONTROLLER://:9093"
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: "PLAINTEXT:PLAINTEXT,CONTROLLER:PLAINTEXT"
      KAFKA_INTER_BROKER_LISTENER_NAME: "PLAINTEXT"
      KAFKA_ADVERTISED_LISTENERS: "PLAINTEXT://localhost:9092"
      # Ajustes para cluster de nó único
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1    # 1 réplica (já que não há outro broker)
      KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 0
      # Cluster ID (ver seção abaixo)
      CLUSTER_ID: "5L6g3nShT-eMCtK--X86sw"       # Substitua por UUID gerado manualmente
